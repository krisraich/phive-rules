<?xml version="1.0" encoding="UTF-8"?>

<!--
******************************************************************************************************************

		OIOUBL Schematron

		publisher:          NemHandel / Erhvervsstyrelsen
        Repository path:    $HeadURL$
        File version:       $Revision$
        Last changed by:    $Author$
        Last changed date:  $Date$

		Description:        This document is produced as part of the OIOUBL schematron package
		Rights:             It can be used following the Common Creative Licence

		all terms derived from http://dublincore.org/documents/dcmi-terms/

		For more information, see www.oioubl.info or email support@nemhandel.dk

******************************************************************************************************************
-->

<sch:schema xmlns:sch="http://purl.oclc.org/dsdl/schematron">

	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:OrderChange-2"                  prefix="doc"/>
	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2"    prefix="cac"/>
	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2"        prefix="cbc"/>
	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:CoreComponentParameters-2"      prefix="ccts"/>
	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:SpecializedDatatypes-2"         prefix="sdt"/>
	<sch:ns uri="urn:un:unece:uncefact:data:specification:UnqualifiedDataTypesSchemaModule:2" prefix="udt"/>
	<!-- [Release 20120615] Check added according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=934 -->
	<sch:ns uri="urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2" prefix="ext"/>
	<sch:ns uri="http://www.w3.org/2001/XMLSchema"                                            prefix="xs"/>

	<sch:p>Schematron for validating OIOUBL-2.1 documents.</sch:p>
	<sch:title>Checking OIOUBL-2.1 OrderChange</sch:title>


	<!-- Inclusion of OIOUBL codelist variables -->
	<sch:include href="OIOUBL_Codelist_Schematron.xml"/>


	<!-- Global variables -->


	<!-- The default phase to execute when validating -->
	<sch:phase id="default">
		<sch:active pattern="ublextensions"/>
		<sch:active pattern="profile"/>
		<sch:active pattern="orderchange"/>
		<sch:active pattern="validityperiod"/>
		<sch:active pattern="orderreference"/>
		<sch:active pattern="quotationdocumentreference"/>
		<sch:active pattern="originatordocumentreference"/>
		<sch:active pattern="additionaldocumentreference"/>
		<sch:active pattern="contract"/>
		<sch:active pattern="signature"/>
		<sch:active pattern="buyercustomerparty"/>
		<sch:active pattern="sellersupplierparty"/>
		<sch:active pattern="originatorcustomerparty"/>
		<sch:active pattern="freightforwarderparty"/>
		<sch:active pattern="accountingcustomerparty"/>
		<sch:active pattern="accountingsupplierparty"/>
		<sch:active pattern="delivery"/>
		<sch:active pattern="deliveryterms"/>
		<sch:active pattern="transactionconditions"/>
		<sch:active pattern="allowancecharge"/>
		<sch:active pattern="destinationcountry"/>
		<sch:active pattern="taxtotal"/>
		<sch:active pattern="anticipatedmonetarytotal"/>
		<sch:active pattern="orderline"/>
	</sch:phase>


	<!-- Inclusion of OIOUBL common rules -->
	<sch:include href="OIOUBL_Common_Schematron.xml"/>


	<!-- - - - - - - - - - - -  UBLExtensions - - - - - - - - - - - - -  -->
	<!-- [Release 20120615] Check added according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=934 -->
	<sch:pattern name="UBLExtensions" id="ublextensions">
		<sch:p>Pattern for validating the UBLExtensions class</sch:p>
		<sch:rule context="doc:OrderChange">
			<sch:extends rule="UBLExtensionsCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  Profile - - - - - - - - - - - - -  -->
	<sch:pattern name="Profile" id="profile">
		<sch:p>Pattern for validating root element, Profile and UBL version</sch:p>
		<!-- Validate root element -->
		<sch:rule context="/">
			<sch:assert test="local-name(*) = 'OrderChange'">[F-OCH001] Root element must be OrderChange</sch:assert>
			<!-- [Release 20130315] Check added according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=1023 -->
			<sch:assert test="namespace-uri(*) = 'urn:oasis:names:specification:ubl:schema:xsd:OrderChange-2'">[F-OCH189] The documenttype does not match an OIOUBL OrderChange and can not be validated by this schematron.</sch:assert>
		</sch:rule>
		<sch:rule context="doc:OrderChange">
			<!-- Check ProfileID, UBLVersionID and CustomizationID -->
			<sch:extends rule="UBLVersionIDCheck"/>
			<sch:extends rule="CustomizationIDCheck"/>
			<sch:extends rule="ProfileIDCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  OrderChange (OCH181)- - - - - - - - - - -  -->
	<sch:pattern name="OrderChange" id="orderchange">
		<sch:p>Pattern for validating the OrderChange structure</sch:p>
		<sch:rule context="doc:OrderChange">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:LineCountNumeric) = 0">[F-OCH002] LineCountNumeric element must be excluded</sch:assert>
			<sch:assert test="count(cac:PaymentMeans) = 0">[F-OCH003] PaymentMeans class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH004] Invalid ID. Must contain a value</sch:assert>
			<sch:assert test="cbc:SequenceNumberID != ''">[F-OCH005] Invalid SequenceNumberID. Must contain a value</sch:assert>
			<sch:extends rule="AccountingCostCheck"/>
			<sch:report test="count(cac:ValidityPeriod) &gt; 1">[F-OCH009] No more than one ValidityPeriod class may be present</sch:report>
			<sch:report test="count(cac:Contract) &gt; 1">[F-OCH010] No more than one Contract class may be present</sch:report>
			<sch:report test="count(cac:Delivery) &gt; 1">[F-OCH011] No more than one Delivery class may be present</sch:report>
		</sch:rule>

		<!-- Validate SalesOrderID -->
		<!-- Validate CopyIndicator -->

		<!-- Validate UUID -->
		<sch:rule context="doc:OrderChange/cbc:UUID">
			<sch:extends rule="UUIDCheck"/>
		</sch:rule>

		<!-- Validate IssueDate -->
		<!-- Validate IssueTime -->
		<!-- Validate SequenceNumberID -->

		<!-- Validate Note -->
		<sch:rule context="doc:OrderChange/cbc:Note">
			<sch:extends rule="NoteCheck"/>
		</sch:rule>

		<!-- Validate RequestedInvoiceCurrencyCode -->
		<sch:rule context="doc:OrderChange/cbc:RequestedInvoiceCurrencyCode">
			<sch:extends rule="CurrencyCodeCheck"/>
		</sch:rule>

		<!-- Validate DocumentCurrencyCode -->
		<sch:rule context="doc:OrderChange/cbc:DocumentCurrencyCode">
			<sch:extends rule="CurrencyCodeCheck"/>
		</sch:rule>

		<!-- Validate PricingCurrencyCode -->
		<sch:rule context="doc:OrderChange/cbc:PricingCurrencyCode">
			<sch:report test="/*/cac:OrderLine/cac:LineItem/cac:Price/cbc:PriceAmount[@currencyID][@currencyID!=string(current())]">[F-OCH006] There is a PriceAmount where the currencyID does not equal the PricingCurrencyCode</sch:report>
			<sch:extends rule="CurrencyCodeCheck"/>
		</sch:rule>

		<!-- Validate TaxCurrencyCode -->
		<sch:rule context="doc:OrderChange/cbc:TaxCurrencyCode">
			<sch:report test="//cbc:TaxAmount[@currencyID][@currencyID!=string(current())]">[F-OCH007] There is a TaxAmount where the currencyID does not equal the TaxCurrencyCode</sch:report>
			<sch:assert test=".='DKK' or . ='EUR'">[F-OCH008] TaxCurrencyCode must be either DKK or EUR</sch:assert>
			<!-- <sch:assert test="count(/*/cac:TaxExchangeRate) != 0">[F-OCHxxx] One TaxExchangeRate class must be present when TaxCurrencyCode element is used</sch:assert> -->
			<!-- <sch:assert test="count(/*/cac:TaxTotal/cac:TaxSubtotal/cbc:TransactionCurrencyTaxAmount) != 0">[F-OCHxxx] One TransactionCurrencyTaxAmount element must be present when TaxCurrencyCode element is used</sch:assert> -->
		</sch:rule>

		<!-- Validate CustomerReference -->
		<!-- Validate AccountingCostCode (ok, see above) -->
		<!-- Validate AccountingCost (ok, see above) -->
		<!-- Validate LineCountNumeric (excluded) -->
	</sch:pattern>

	<!-- - - - - - - - - - - -  ValidityPeriod - - - - - - - - - - -  -->
	<sch:pattern name="ValidityPeriod" id="validityperiod">
		<sch:p>Pattern for validating the ValidityPeriod class</sch:p>
		<sch:rule context="doc:OrderChange/cac:ValidityPeriod">
			<!-- Validate -->
			<sch:extends rule="PeriodCheck"/>
			<sch:extends rule="DescriptionLanguageCheckNew"/>
		</sch:rule>
		<!-- Validate Description -->
	
	</sch:pattern>

	<!-- - - - - - - - - - - -  OrderReference - - - - - - - - - - -  -->
	<sch:pattern name="OrderReference" id="orderreference">
		<sch:p>Pattern for validating the OrderReference class</sch:p>
		<sch:rule context="doc:OrderChange/cac:OrderReference">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH014] Invalid ID. Must contain a value</sch:assert>
		</sch:rule>
		<!-- Validate UUID -->
		<sch:rule context="OrderChange/cac:OrderReference/cbc:UUID">
			<sch:extends rule="UUIDCheck"/>
		</sch:rule>
		<!-- Validate IssueDate -->
		<!-- Validate CustomerReference -->
		<!-- Validate DocumentReference -->
		<sch:rule context="OrderChange/cac:OrderReference/cac:DocumentReference">
			<sch:extends rule="KnownDocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  QuotationDocumentReference - - - - - - - - - - -  -->
	<sch:pattern name="QuotationDocumentReference" id="quotationdocumentreference">
		<sch:p>Pattern for validating the QuotationDocumentReference class</sch:p>
		<sch:rule context="doc:OrderChange/cac:QuotationDocumentReference">
			<sch:extends rule="KnownDocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  OriginatorDocumentReference - - - - - - - - - - -  -->
	<sch:pattern name="OriginatorDocumentReference" id="originatordocumentreference">
		<sch:p>Pattern for validating the OriginatorDocumentReference class</sch:p>
		<sch:rule context="doc:OrderChange/cac:OriginatorDocumentReference">
			<sch:extends rule="KnownDocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  AdditionalDocumentReference - - - - - - - - - - -  -->
	<sch:pattern name="AdditionalDocumentReference" id="additionaldocumentreference">
		<sch:p>Pattern for validating the AdditionalDocumentReference class</sch:p>
		<sch:rule context="doc:OrderChange/cac:AdditionalDocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  Contract - - - - - - - - - - -  -->
	<sch:pattern name="Contract" id="contract">
		<sch:p>Pattern for validating the Contract class</sch:p>
		<sch:rule context="doc:OrderChange/cac:Contract">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:IssueDate) = 0">[F-OCH015] IssueDate element must be excluded</sch:assert>
			<sch:assert test="count(cbc:IssueTime) = 0">[F-OCH016] IssueTime element must be excluded</sch:assert>
			<sch:assert test="count(cac:ValidityPeriod) = 0">[F-OCH017] ValidityPeriod class must be excluded</sch:assert>
			<sch:assert test="count(cac:ContractDocumentReference) = 0">[F-OCH018] ContractDocumentReference class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:ID != ''">[F-OCH019] Invalid ID. Must contain a value</sch:assert>
			<!-- Validate -->
			<sch:report test="cbc:ContractType and cbc:ContractTypeCode">[F-OCH020] Use either ContractType or ContractTypeCode</sch:report>
		</sch:rule>
		<!-- Validate ContractDocumentReference (excluded) -->
	</sch:pattern>

	<!-- - - - - - - - - - - -  Signature - - - - - - - - - - -  -->
	<sch:pattern name="Signature" id="signature">
		<sch:p>Pattern for validating the Signature class</sch:p>
		<sch:rule context="doc:OrderChange/cac:Signature">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH021] Invalid ID. Must contain a value</sch:assert>
		</sch:rule>
		<!-- Validate SignatoryParty -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH022] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>
		<!-- Validate SignatoryParty/PartyIdentification -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PartyName -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PostalAddress -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PhysicalLocation -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PhysicalLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PhysicalLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PhysicalLocation/ValidityPeriod/Description -->

		<!-- Validate SignatoryParty/PhysicalLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PartyTaxScheme -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PartyTaxScheme/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/PartyLegalEntity -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/Contact -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
		<!-- Validate SignatoryParty/Person -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:SignatoryParty/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- Validate DigitalSignatureAttachment -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:DigitalSignatureAttachment">
			<sch:extends rule="AttachmentCheck"/>
		</sch:rule>

		<!-- Validate OriginalDocumentReference -->
		<sch:rule context="doc:OrderChange/cac:Signature/cac:OriginalDocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  BuyerCustomerParty - - - - - - - - - - -  -->
	<sch:pattern name="BuyerCustomerParty" id="buyercustomerparty">
		<sch:p>Pattern for validating the BuyerCustomerParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:CustomerAssignedAccountID) = 0">[F-OCH023] CustomerAssignedAccountID element must be excluded</sch:assert>
			<sch:assert test="count(cbc:AdditionalAccountID) = 0">[F-OCH024] AdditionalAccountID element must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="count(cac:Party) = 1">[F-OCH025] One Party class must be present</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  Party - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:EndpointID != ''">[F-OCH026] Invalid EndpointID. Must contain a value</sch:assert>
			<sch:assert test="count(cac:PartyLegalEntity) = 1">[F-OCH027] One PartyLegalEntity class must be present</sch:assert>
			<sch:assert test="count(cac:Contact) = 1">[F-OCH028] One Contact class must be present</sch:assert>
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PhysicalLocation">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PhysicalLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
	
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:Contact">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:ID != ''">[F-OCH029] Invalid ID. Must contain a value</sch:assert>
			<!-- Validate -->
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:Party/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  DeliveryContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:DeliveryContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  AccountingContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:AccountingContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  BuyerContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:BuyerCustomerParty/cac:BuyerContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  SellerSupplierParty - - - - - - - - - - -  -->
	<sch:pattern name="SellerSupplierParty" id="sellersupplierparty">
		<sch:p>Pattern for validating the SellerSupplierParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:DataSendingCapability) = 0">[F-OCH030] DataSendingCapability element must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="count(cac:Party) = 1">[F-OCH031] Party class must be present</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  Party - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:EndpointID != ''">[F-OCH032] Invalid EndpointID. Must contain a value</sch:assert>
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH033] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PhysicalLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
		
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:Party/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  DespatchContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:DespatchContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  AccountingContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:AccountingContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  SellerContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:SellerSupplierParty/cac:SellerContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  OriginatorCustomerParty - - - - - - - - - - -  -->
	<sch:pattern name="OriginatorCustomerParty" id="originatorcustomerparty">
		<sch:p>Pattern for validating the OriginatorCustomerParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="count(cac:Party) = 1">[F-OCH034] Party class must be present</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  Party - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH035] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PhysicalLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
	
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:Party/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  DeliveryContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:DeliveryContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  AccountingContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:AccountingContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  BuyerContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OriginatorCustomerParty/cac:BuyerContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  FreightForwarderParty - - - - - - - - - - -  -->
	<sch:pattern name="FreightForwarderParty" id="freightforwarderparty">
		<sch:p>Pattern for validating the FreightForwarderParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH036] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PhysicalLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
	
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:FreightForwarderParty/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  AccountingCustomerParty - - - - - - - - - - -  -->
	<sch:pattern name="AccountingCustomerParty" id="accountingcustomerparty">
		<sch:p>Pattern for validating the AccountingCustomerParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="count(cac:Party) = 1">[F-OCH037] Party class must be present</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  Party - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:EndpointID != ''">[F-OCH038] Invalid EndpointID. Must contain a value</sch:assert>
			<sch:assert test="count(cac:PartyLegalEntity) = 1">[F-OCH039] One PartyLegalEntity class must be present</sch:assert>
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PhysicalLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
		
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:Party/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  DeliveryContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:DeliveryContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  AccountingContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:AccountingContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  BuyerContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingCustomerParty/cac:BuyerContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  AccountingSupplierParty - - - - - - - - - - -  -->
	<sch:pattern name="AccountingSupplierParty" id="accountingsupplierparty">
		<sch:p>Pattern for validating the AccountingSupplierParty class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:DataSendingCapability) = 0">[F-OCH040] DataSendingCapability element must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="count(cac:Party) = 1">[F-OCH041] Party class must be present</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  Party - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH042] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyName - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PostalAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PhysicalLocation - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PhysicalLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod/Description -->
	
		<!-- Validate Address -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyTaxScheme/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  PartyLegalEntity - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Contact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Person - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:Party/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  DespatchContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:DespatchContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  AccountingContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:AccountingContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  SellerContact - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:AccountingSupplierParty/cac:SellerContact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  Delivery - - - - - - - - - - -  -->
	<sch:pattern name="Delivery" id="delivery">
		<sch:p>Pattern for validating the Delivery class</sch:p>
		<sch:rule context="doc:OrderChange/cac:Delivery">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:ID) = 0">[F-OCH043] ID element must be excluded</sch:assert>
			<sch:assert test="count(cbc:ActualDeliveryDate) = 0">[F-OCH044] ActualDeliveryDate element must be excluded</sch:assert>
			<sch:assert test="count(cbc:ActualDeliveryTime) = 0">[F-OCH045] ActualDeliveryTime element must be excluded</sch:assert>
			<sch:assert test="count(cac:DeliveryAddress) = 0">[F-OCH046] DeliveryAddress class must be excluded</sch:assert>
			<sch:assert test="count(cac:PromisedDeliveryPeriod) = 0">[F-OCH047] PromisedDeliveryPeriod class must be excluded</sch:assert>
			<sch:assert test="count(cac:EstimatedDeliveryPeriod) = 0">[F-OCH048] EstimatedDeliveryPeriod class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:report test="cac:DeliveryParty and ../cac:BuyerCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID = cac:DeliveryParty/cac:PartyIdentification/cbc:ID">[F-OCH049] DeliveryParty must be different from BuyerCustomerParty</sch:report>
			<sch:report test="cac:DeliveryParty and ../cac:BuyerCustomerParty/cac:Party/cac:PartyName/cbc:Name = cac:DeliveryParty/cac:PartyName/cbc:Name">[F-OCH050] DeliveryParty must be different from BuyerCustomerParty</sch:report>
			<sch:report test="cac:DeliveryParty and ../cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID = cac:DeliveryParty/cac:PartyIdentification/cbc:ID">[F-OCH051] DeliveryParty must be different from AccountingCustomerParty</sch:report>
			<sch:report test="cac:DeliveryParty and ../cac:AccountingCustomerParty/cac:Party/cac:PartyName/cbc:Name = cac:DeliveryParty/cac:PartyName/cbc:Name">[F-OCH052] DeliveryParty must be different from AccountingCustomerParty</sch:report>
			<!-- <sch:report test="cac:Despath">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>
		<!-- Validate DeliveryLocation -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryLocation">
			<!-- Check for mandatory elements -->
			<sch:report test="not(cbc:ID) and not(cac:Address)">[F-OCH053] Address is mandatory when ID is not specified</sch:report>
			<!-- Validate -->
			<!-- ID -->
			<!-- Description -->
			<!-- Conditions -->
			<!-- CountrySubentity -->
			<!-- CountrySubentityCode -->
		</sch:rule>
		<!-- Validate DeliveryLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryLocation/ValidityPeriod/Description -->
		
		<!-- Validate DeliveryLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate RequestedDeliveryPeriod -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:RequestedDeliveryPeriod">
            <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate RequestedDeliveryPeriod/Description -->
		
		<!-- Validate DeliveryParty -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH054] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyIdentification -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyName -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PostalAddress -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod/Description -->
	
		<!-- Validate DeliveryParty/PhysicalLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyLegalEntity -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Contact -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Person -->
		<sch:rule context="doc:OrderChange/cac:Delivery/cac:DeliveryParty/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  DeliveryTerms - - - - - - - - - - -  -->
	<sch:pattern name="DeliveryTerms" id="deliveryterms">
		<sch:p>Pattern for validating the DeliveryTerms class</sch:p>
		<sch:rule context="doc:OrderChange/cac:DeliveryTerms">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cac:AllowanceCharge) = 0">[F-OCH055] AllowanceCharge class must be excluded</sch:assert>

			<!-- Check for mandatory elements -->

			<!-- Validate -->
			<sch:report test="cbc:ID and cbc:SpecialTerms">[F-OCH056] Use either ID or SpecialTerms</sch:report>
			<sch:report test="cbc:ID and not(cbc:ID = 'Incoterms' or cbc:ID = 'INCOTERMS')">[W-OCH057] If used, use INCO terms (ID = 'INCOTERMS')</sch:report>
			<sch:report test="cbc:LossRiskResponsibilityCode and cbc:LossRisk">[F-OCH058] Use either LossRiskResponsibilityCode or LossRisk</sch:report>
		</sch:rule>
		<!-- Validate DeliveryTerms/DeliveryLocation -->
		<sch:rule context="doc:OrderChange/cac:DeliveryTerms/cac:DeliveryLocation">
		</sch:rule>
		<!-- Validate DeliveryTerms/DeliveryLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:DeliveryTerms/cac:DeliveryLocation/cac:ValidityPeriod">
	    	<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryTerms/DeliveryLocation/ValidityPeriod/Description -->
		
		<!-- Validate DeliveryTerms/DeliveryLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:DeliveryTerms/cac:DeliveryLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  PaymentMeans (excluded) - - - - - - - - - - -  -->

	<!-- - - - - - - - - - - -  TransactionConditions - - - - - - - - - - -  -->
	<sch:pattern name="TransactionConditions" id="transactionconditions">
		<sch:p>Pattern for validating the TransactionConditions class</sch:p>
		<sch:rule context="doc:OrderChange/cac:TransactionConditions">
		<sch:extends rule="DescriptionLanguageCheckNew"/>
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
		</sch:rule>
		<!-- Validate TransactionConditions/Description -->
		
		<!-- Validate TransactionConditions/DocumentReference -->
		<sch:rule context="doc:OrderChange/cac:TransactionConditions/cac:DocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  AllowanceCharge - - - - - - - - - - -  -->
	<sch:pattern name="AllowanceCharge" id="allowancecharge">
		<sch:p>Pattern for validating the AllowanceCharge class</sch:p>
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge">
			<sch:extends rule="AllowanceChargeTopCheck"/>
			<sch:extends rule="AccountingCostCheck"/>
		</sch:rule>
		<!-- Validate PrepaidIndicator -->
		<!-- Validate SequenceNumeric -->
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge/cbc:SequenceNumeric">
			<sch:extends rule="PosNumberCheck"/>
		</sch:rule>
		<!-- Validate Amount -->
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge/cbc:Amount">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate BaseAmount -->
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge/cbc:BaseAmount">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate TaxCategory -->
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge/cac:TaxCategory">
			<sch:extends rule="TaxCategoryCheck"/>
		</sch:rule>
		<!-- Validate TaxCategory/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  DestinationCountry - - - - - - - - - - -  -->
	<sch:pattern name="DestinationCountry" id="destinationcountry">
		<sch:p>Pattern for validating the DestinationCountry class</sch:p>
		<sch:rule context="doc:OrderChange/cac:DestinationCountry">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:IdentificationCode != ''">[F-OCH059] Invalid IdentificationCode. Must contain a value</sch:assert>
			<!-- Validate -->
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  TaxTotal - - - - - - - - - - -  -->
	<sch:pattern name="TaxTotal" id="taxtotal">
		<sch:p>Pattern for validating the TaxTotal class</sch:p>
		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:TaxTotal">
			<sch:extends rule="TaxTotalCheck"/>
		</sch:rule>
		<!-- - - - - - - - - - - -  TaxSubtotal - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:TaxTotal/cac:TaxSubtotal">
			<sch:extends rule="TaxSubtotalCheck"/>
		</sch:rule>
		<!-- - - - - - - - - - - -  TaxCategory - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:TaxTotal/cac:TaxSubtotal/cac:TaxCategory">
			<sch:extends rule="TaxCategoryCheck"/>
		</sch:rule>
		<!-- - - - - - - - - - - -  TaxCategory/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:TaxTotal/cac:TaxSubtotal/cac:TaxCategory/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  AnticipatedMonetaryTotal - - - - - - - - - - -  -->
	<sch:pattern name="AnticipatedMonetaryTotal" id="anticipatedmonetarytotal">
		<sch:p>Pattern for validating the AnticipatedMonetaryTotal class</sch:p>
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:LineExtensionAmount != ''">[F-OCH060] Invalid LineExtensionAmount. Must contain a value</sch:assert>
			<sch:report test="count(../cac:AllowanceCharge[cbc:ChargeIndicator='false']) and not(cbc:AllowanceTotalAmount)">[F-OCH062] AllowanceTotalAmount is mandatory when AllowanceCharge classes (with ChargeIndicator='false') are present</sch:report>
			<sch:report test="count(../cac:AllowanceCharge[cbc:ChargeIndicator='true']) and not(cbc:ChargeTotalAmount)">[F-OCH063] ChargeTotalAmount is mandatory when AllowanceCharge classes (with ChargeIndicator='true') are present</sch:report>
			<sch:report test="count(../cac:PrepaidPayment/cbc:PaidAmount) and not(cbc:PrepaidAmount)">[F-OCH064] PrepaidAmount is mandatory when PrepaidPayment/PaidAmount elements are present</sch:report>
			<sch:report test="count(../cac:TaxTotal/cbc:RoundingAmount) and not(cbc:PayableRoundingAmount)">[F-OCH065] PayableRoundingAmount is mandatory when TaxTotal/RoundingAmount elements are present</sch:report>
			<!-- Validate -->
			<!-- [Release 20120615] Check changed according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=823 -->
			<sch:report test="((cbc:LineExtensionAmount - sum(../cac:OrderLine/cac:LineItem/cbc:LineExtensionAmount)) &gt; 0.0055) or ((cbc:LineExtensionAmount - sum(../cac:OrderLine/cac:LineItem/cbc:LineExtensionAmount)) &lt; -0.0055)">[F-OCH066] The sum of Orderline/LineItem/LineExtensionAmount elements must equal LineExtensionAmount</sch:report>
			<sch:report test="cbc:TaxExclusiveAmount and not(format-number(cbc:TaxExclusiveAmount,'##.00') = format-number(sum(../cac:TaxTotal/cac:TaxSubtotal/cbc:TaxAmount),'##.00'))">[F-OCH067] The sum of TaxTotal/TaxSubtotal/TaxAmount elements must equal TaxExclusiveAmount</sch:report>
			<sch:report test="cbc:TaxInclusiveAmount and not(format-number(cbc:TaxInclusiveAmount,'##.00') = format-number(sum(cbc:LineExtensionAmount) + sum(../cac:TaxTotal/cac:TaxSubtotal/cbc:TaxAmount) + sum(cbc:ChargeTotalAmount) - sum(cbc:AllowanceTotalAmount) + sum(cbc:PayableRoundingAmount),'##.00'))">[F-OCH068] TaxInclusiveAmount is calculated incorrectly</sch:report>
			<sch:report test="cbc:AllowanceTotalAmount and not(format-number(cbc:AllowanceTotalAmount,'##.00') = format-number(sum(../cac:AllowanceCharge[cbc:ChargeIndicator='false']/cbc:Amount),'##.00'))">[F-OCH069] The sum of AllowanceCharge/Amount elements (with ChargeIndicator='false') must equal AllowanceTotalAmount</sch:report>
			<sch:report test="cbc:ChargeTotalAmount and not(format-number(cbc:ChargeTotalAmount,'##.00') = format-number(sum(../cac:AllowanceCharge[cbc:ChargeIndicator='true']/cbc:Amount),'##.00'))">[F-OCH070] The sum of AllowanceCharge/Amount elements (with ChargeIndicator='true') must equal cbc:ChargeTotalAmount</sch:report>
			<sch:report test="cbc:PrepaidAmount and not(format-number(cbc:PrepaidAmount,'##.00') = format-number(sum(../cac:PrepaidPayment/cbc:PaidAmount),'##.00'))">[F-OCH071] The sum of PrepaidPayment/PaidAmount elements must equal PrepaidAmount</sch:report>
			<sch:report test="cbc:PayableRoundingAmount and not(format-number(cbc:PayableRoundingAmount,'##.00') = format-number(sum(../cac:TaxTotal/cbc:RoundingAmount),'##.00'))">[F-OCH072] The sum of TaxTotal/RoundingAmount elements must equal PayableRoundingAmount</sch:report>
			<sch:assert test="format-number(cbc:PayableAmount,'##.00') = format-number(sum(cbc:LineExtensionAmount) + sum(../cac:TaxTotal/cac:TaxSubtotal/cbc:TaxAmount) + sum(cbc:ChargeTotalAmount) - sum(cbc:AllowanceTotalAmount) - sum(cbc:PrepaidAmount) + sum(cbc:PayableRoundingAmount),'##.00')">[F-OCH073] PayableAmount is calculated incorrectly</sch:assert>
			<!-- <sch:report test="../cbc:TaxCurrencyCode">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>
		<!-- Validate LineExtensionAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:LineExtensionAmount">
			<!-- [Release 20111201] Changing check according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=657 -->
			<!--<sch:extends rule="PosZeroDecNumberCheck"/>-->
			<!-- sch:extends rule="ZeroDecNumberCheck"/ -->
			<!-- [Release 20140915] Changing check according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=1309 -->
			<sch:extends rule="DecNumberCheck"/>
		</sch:rule>
		<!-- Validate TaxExclusiveAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:TaxExclusiveAmount">
			<sch:extends rule="DecNumberCheck"/>
		</sch:rule>
		<!-- Validate TaxInclusiveAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:TaxInclusiveAmount">
			<!-- [Release 20140915] Changing check according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=1309 -->
			<!-- sch:extends rule="PosZeroDecNumberCheck"/ -->
			<sch:extends rule="PosDecNumberCheck"/>
		</sch:rule>
		<!-- Validate AllowanceTotalAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:AllowanceTotalAmount">
			<sch:extends rule="PosZeroDecNumberCheck"/>
		</sch:rule>
		<!-- Validate ChargeTotalAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:ChargeTotalAmount">
			<sch:extends rule="PosZeroDecNumberCheck"/>
		</sch:rule>
		<!-- Validate PrepaidAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:PrepaidAmount">
			<sch:extends rule="PosZeroDecNumberCheck"/>
		</sch:rule>
		<!-- Validate PayableRoundingAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:PayableRoundingAmount">
			<sch:extends rule="ZeroDecNumberCheck"/>
		</sch:rule>
		<!-- Validate PayableAmount -->
		<sch:rule context="doc:OrderChange/cac:AnticipatedMonetaryTotal/cbc:PayableAmount">
			<!-- [Release 20140915] Changing check according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=1309 -->
			<!-- sch:extends rule="PosZeroDecNumberCheck"/ -->
			<sch:extends rule="PosDecNumberCheck"/>
		</sch:rule>
	</sch:pattern>

	<!-- - - - - - - - - - - -  OrderLine - - - - - - - - - - -  -->
	<sch:pattern name="OrderLine" id="orderline">
		<sch:p>Pattern for validating the OrderLine class</sch:p>

		<!-- - - - - - - - - - - -  Top-level checks - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:SubstitutionStatusCode) = 0">[F-OCH124] SubstitutionStatusCode element must be excluded</sch:assert>
			<sch:assert test="count(cac:SellerProposedSubstituteLineItem) = 0">[F-OCH125] SellerProposedSubstituteLineItem class must be excluded</sch:assert>
			<sch:assert test="count(cac:SellerSubstitutedLineItem) = 0">[F-OCH126] SellerSubstitutedLineItem class must be excluded</sch:assert>
			<sch:assert test="count(cac:CatalogueLineReference) = 0">[F-OCH128] CatalogueLineReference class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- [Release 20120615] Added 5 new checks according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=730 -->
			<!-- 1 -->
			<sch:report test="cac:LineItem/cac:Delivery/cbc:LatestDeliveryDate and count(../cac:Delivery/cbc:LatestDeliveryDate)">[F-OCH183] Only use Delivery.LatestDeliveryDate if not specified on header level (OrderChange.Delivery)</sch:report>
			<!-- 2 -->
			<sch:report test="cac:LineItem/cac:Delivery/cbc:LatestDeliveryTime and count(../cac:Delivery/cbc:LatestDeliveryTime)">[F-OCH184] Only use Delivery.LatestDeliveryTime if not specified on header level (OrderChange.Delivery)</sch:report>
			<!-- 3 -->
			<sch:report test="cac:LineItem/cac:Delivery/cac:RequestedDeliveryPeriod and count(../cac:Delivery/cac:RequestedDeliveryPeriod)">[F-OCH185] Only use Delivery.RequestedDeliveryPeriod if not specified on header level (OrderChange.Delivery)</sch:report>
			<!-- 4-->
			<sch:report test="cac:LineItem/cac:Delivery/cac:DeliveryLocation and count(../cac:Delivery/cac:DeliveryLocation)">[F-OCH186] Only use Delivery.DeliveryLocation if not specified on header level (OrderChange.Delivery)</sch:report>
			<!-- 5 -->
			<sch:report test="cac:LineItem/cac:Delivery/cac:DeliveryParty and count(../cac:Delivery/cac:DeliveryParty)">[F-OCH187] Only use Delivery.DeliveryParty if not specified on header level (OrderChange.Delivery)</sch:report>

			<sch:report test="./cac:LineItem/cbc:ID = ./following-sibling::*/cac:LineItem/cbc:ID">[W-OCH074] ID must be unique within the document instance</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem">
			<!-- Variables -->
			<sch:let name="L" value="not(cbc:LineExtensionAmount)"/>
			<sch:let name="T" value="not(cac:Price/cbc:OrderableUnitFactorRate)"/>

			<!-- [Release 20120615] Variable added according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<sch:let name="NegativeLEA" value="starts-with(cbc:Quantity,'-')"/>
			<sch:let name="NegativePA" value="starts-with(cac:Price/cbc:PriceAmount,'-')"/>
			<sch:let name="P" value="not(cac:Price)"/>

			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:SalesOrderID) = 0">[F-OCH129] SalesOrderID element must be excluded</sch:assert>
			<sch:assert test="count(cac:DeliveryTerms) = 0">[F-OCH130] DeliveryTerms class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:Quantity != ''">[F-OCH131] Invalid Quantity. Must contain a value</sch:assert>
			<!-- Validate -->
			<!-- [Release 20120615] Check added according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<sch:report test="not($NegativeLEA or $NegativePA) and starts-with(cac:AllowanceCharge/cbc:Amount,'-')">[F-OCH188] AllowanceCharge.Amount can not be negative, if Quantity or Price.PriceAmount are not negative.</sch:report>
			<sch:report test="not($P) and not($NegativeLEA or $NegativePA) and starts-with(cac:Price/cac:AllowanceCharge/cbc:Amount,'-')">[F-OCH188] AllowanceCharge.Amount can not be negative, if Quantity or Price.PriceAmount are not negative.</sch:report>

			<sch:assert test="cbc:ID != ''">[F-OCH132] Invalid ID. Must contain a value</sch:assert>
			<sch:extends rule="AccountingCostCheck"/>
			<sch:report test="(not($L) and $T) and ((cbc:LineExtensionAmount &lt; (cbc:Quantity * cac:Price/cbc:PriceAmount - 01.00)) or (cbc:LineExtensionAmount &gt; (cbc:Quantity * cac:Price/cbc:PriceAmount + 01.00)))">[F-OCH140] When present, LineExtensionAmount must equal Quantity * Price.PriceAmount (when OrderableUnitFactorRate not present)</sch:report>
			<sch:report test="(not($L) and not($T)) and ((cbc:LineExtensionAmount &lt; (cbc:Quantity * cac:Price/cbc:PriceAmount * cac:Price/cbc:OrderableUnitFactorRate - 01.00)) or (cbc:LineExtensionAmount &gt; (cbc:Quantity * cac:Price/cbc:PriceAmount * cac:Price/cbc:OrderableUnitFactorRate + 01.00)))">[F-OCH179] When present, LineExtensionAmount must equal Quantity * Price.PriceAmount * Price.OrderableUnitFactorRate</sch:report>
		</sch:rule>
		<!-- Validate UUID -->
		<!-- Validate Note -->
		<!-- Validate LineStatusCode -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:LineStatusCode">
			<sch:assert test="./@listID = $LineStatus_listID">[F-OCH133] Invalid listID. Must be '<sch:value-of select="$LineStatus_listID"/>'</sch:assert>
			<sch:assert test="./@listAgencyID = $LineStatus_agencyID">[F-OCH134] Invalid listAgencyID. Must be '<sch:value-of select="$LineStatus_agencyID"/>'</sch:assert>
			<sch:assert test="contains($LineStatus, concat(',',.,','))">[F-OCH181] Invalid LineStatusCode: '<sch:value-of select="."/>'. Must be a value from the codelist</sch:assert>
		</sch:rule>
		<!-- Validate Quantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:Quantity">
			<sch:extends rule="unitCodeCheck"/>
			<sch:report test="string-length(substring-after(., '.')) &lt; 2">[F-OCH135] Invalid Quantity. Must have at least 2 decimals</sch:report>
			<!-- [Release 20120615] Check changed according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=723 -->
			<!-- 270122: NH-51 - no restriction on decimals -->
			<!-- sch:report test="string-length(substring-after(., '.')) &gt; 6">[F-OCH136] Invalid Quantity. No more than 6 decimals</sch:report-->
			<sch:assert test=". != 0">[F-OCH137] Invalid Quantity. Must not be zero</sch:assert>
		</sch:rule>
		<!-- Validate LineExtensionAmount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:LineExtensionAmount">
			<sch:report test="string-length(substring-after(., '.')) &lt; 2">[F-OCH138] Invalid LineExtensionAmount. Must have at least 2 decimals</sch:report>
			<sch:report test="string-length(substring-after(., '.')) &gt; 4">[F-OCH139] Invalid LineExtensionAmount. No more than 4 decimals</sch:report>
		</sch:rule>
		<!-- Validate TotalTaxAmount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:TotalTaxAmount">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate MinimunQuantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:MinimunQuantity">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate MaximunQuantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:MaximunQuantity">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate MinimunBackorderQuantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:MinimunBackorderQuantity">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate MaximunBackorderQuantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cbc:MaximunBackorderQuantity">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate InspectionMethodCode -->
		<!-- Validate PartialDeliveryIndicator -->
		<!-- Validate BackOrderAllowedIndicator -->
		<!-- Validate AccountingCostCode (OK see above) -->
		<!-- Validate AccountingCost (OK see above) -->

		<!-- - - - - - - - - - - -  LineItem/Delivery - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cbc:ID) = 0">[F-OCH141] ID element must be excluded</sch:assert>
			<sch:assert test="count(cbc:ActualDeliveryDate) = 0">[F-OCH142] ActualDeliveryDate element must be excluded</sch:assert>
			<sch:assert test="count(cbc:ActualDeliveryTime) = 0">[F-OCH143] ActualDeliveryTime element must be excluded</sch:assert>
			<sch:assert test="count(cbc:TrackingID) = 0">[F-OCH144] TrackingID element must be excluded</sch:assert>
			<sch:assert test="count(cac:DeliveryAddress) = 0">[F-OCH145] DeliveryAddress class must be excluded</sch:assert>
			<sch:assert test="count(cac:PromisedDeliveryPeriod) = 0">[F-OCH146] PromisedDeliveryPeriod class must be excluded</sch:assert>
			<sch:assert test="count(cac:EstimatedDeliveryPeriod) = 0">[F-OCH147] EstimatedDeliveryPeriod class must be excluded</sch:assert>

			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="cac:Despath">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>
		<!-- Validate DeliveryLocation -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryLocation">
			<!-- Check for mandatory elements -->
			<sch:report test="not(cbc:ID) and not(cac:Address)">[F-OCH148] Address is mandatory when ID is not specified</sch:report>
			<!-- Validate -->
			<!-- ID -->
			<!-- Description -->
			<!-- Conditions -->
			<!-- CountrySubentity -->
			<!-- CountrySubentityCode -->
		</sch:rule>
		<!-- Validate DeliveryLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryLocation/ValidityPeriod/Description -->
	
		<!-- Validate DeliveryLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate RequestedDeliveryPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:RequestedDeliveryPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate RequestedDeliveryPeriod/Description -->
	
		<!-- Validate DeliveryParty -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH149] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyIdentification -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyName -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PostalAddress -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation/cac:ValidityPeriod">
		    <sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod/Description -->

		<!-- Validate DeliveryParty/PhysicalLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyLegalEntity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Contact -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Person -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Delivery/cac:DeliveryParty/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/DeliveryTerms (excluded) - - - - - - - - - - -  -->

		<!-- - - - - - - - - - - -  LineItem/OriginatorParty - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty">
			<!-- Check for excluded elements -->
			<sch:extends rule="PartyExcludedCheck"/>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:extends rule="PartyNameCheck"/>
			<sch:extends rule="EndpointIDCheck"/>
			<sch:report test="count(cac:PartyLegalEntity) &gt; 1">[F-OCH150] No more than one PartyLegalEntity class may be present</sch:report>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyIdentification -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PartyIdentification">
			<sch:extends rule="PartyIdentificationCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyName -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PartyName">
			<sch:extends rule="PartyNameLanguageCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PostalAddress -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PostalAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PhysicalLocation">
			<sch:extends rule="AddressIDCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PhysicalLocation/cac:ValidityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PhysicalLocation/ValidityPeriod/Description -->
		
		<!-- Validate DeliveryParty/PhysicalLocation/Address -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PhysicalLocation/cac:Address">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PartyTaxScheme">
			<sch:extends rule="PartyTaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyTaxScheme/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PartyTaxScheme/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/PartyLegalEntity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:PartyLegalEntity">
			<sch:extends rule="PartyLegalEntityCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Contact -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:Contact">
			<sch:extends rule="ContactCheck"/>
		</sch:rule>
		<!-- Validate DeliveryParty/Person -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OriginatorParty/cac:Person">
			<sch:extends rule="Person/FirstNameCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/OrderedShipment - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:OrderedShipment">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/PricingReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:PricingReference">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/AllowanceCharge - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge">
			<sch:extends rule="AllowanceChargeTopCheck"/>
			<sch:extends rule="AccountingCostCheck"/>
		</sch:rule>
		<!-- Validate PrepaidIndicator -->
		<!-- Validate SequenceNumeric -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge/cbc:SequenceNumeric">
			<sch:extends rule="PosNumberCheck"/>
		</sch:rule>
		<!-- Validate Amount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge/cbc:Amount">
			<!-- [Release 20120615] Check removed according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<!--<sch:extends rule="PosZeroNumberCheck"/>-->
			<!-- [Release 20120615] Check added according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<sch:extends rule="ZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate BaseAmount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge/cbc:BaseAmount">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate TaxCategory -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge/cac:TaxCategory">
			<sch:extends rule="TaxCategoryCheck"/>
		</sch:rule>
		<!-- Validate TaxCategory/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>
		<!-- - - - - - - - - - - -  LineItem/Price - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cac:ValidityPeriod) = 0">[F-OCH151] ValidityPeriod class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<!-- Validate -->
		</sch:rule>
		<!-- Validate PriceAmount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cbc:PriceAmount">
			<sch:report test="string-length(substring-after(., '.')) &lt; 2">[F-OCH152] Invalid PriceAmount. Must have at least 2 decimals</sch:report>
			<sch:report test="string-length(substring-after(., '.')) &gt; 4">[F-OCH153] Invalid PriceAmount. No more than 4 decimals</sch:report>
		</sch:rule>
		<!-- Validate BaseQuantity -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cbc:BaseQuantity">
			<sch:extends rule="unitCodeCheck"/>
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate PriceChangeReason -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cbc:PriceChangeReason">
			<sch:report test="count(../cbc:PriceChangeReason) &gt; 1 and not(./@languageID)">[W-OCH155] The attribute languageID should be used when more than one PriceChangeReason element is present</sch:report>
			<sch:report test="following-sibling::*/@languageID = self::*/@languageID">[W-OCH156] Multilanguage error. Replicated PriceChangeReason elements with same languageID attribute value</sch:report>
		</sch:rule>
		<!-- Validate PriceTypeCode -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cbc:PriceTypeCode">
			<sch:assert test="./@listID = 'UN/ECE 5387'">[F-OCH157] Invalid listID. Must be 'UN/ECE 5387'</sch:assert>
			<sch:assert test="./@listAgencyID = '320' or ./@listAgencyID = '6'">[F-OCH158] Invalid listAgencyID. Must be '6'</sch:assert>
		</sch:rule>
		<!-- Validate PriceType -->
		<!-- Validate OrderableUnitFactorRate -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cbc:OrderableUnitFactorRate">
			<sch:extends rule="PosZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate ValidityPeriod (excluded) -->
		<!-- Validate PriceList -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:PriceList">
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>
		<!-- Validate AllowanceCharge -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge">
			<sch:extends rule="PriceAllowanceChargeTopCheck"/>
		</sch:rule>
		<!-- Validate AllowanceCharge/SequenceNumeric -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge/cbc:SequenceNumeric">
			<sch:extends rule="PosNumberCheck"/>
		</sch:rule>
		<!-- Validate AllowanceCharge/Amount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge/cbc:Amount">
			<!-- [Release 20120615] Check removed according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<!--<sch:extends rule="PosZeroNumberCheck"/>-->
			<!-- [Release 20120615] Check added according to issue: http://bugs.softwareborsen.dk/show_bug.cgi?id=927 -->
			<sch:extends rule="ZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate AllowanceCharge/BaseAmount -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge/cbc:BaseAmount">
			<!-- [Release 20130315] Check changed according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=1066 -->
			<sch:extends rule="ZeroNumberCheck"/>
		</sch:rule>
		<!-- Validate AllowanceCharge/TaxCategory -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge/cac:TaxCategory">
			<sch:extends rule="TaxCategoryCheck"/>
		</sch:rule>
		<!-- Validate AllowanceCharge/TaxCategory/TaxScheme -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Price/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item">
			<!-- Check for excluded elements -->
			<sch:assert test="count(cac:OriginCountry) = 0">[F-OCH159] OriginCountry class must be excluded</sch:assert>
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:Name != ''">[F-OCH160] Invalid Name. Must contain a value</sch:assert>
			<sch:report test="contains(/doc:OrderChange/cbc:ProfileID, 'Procurement-OrdSim') and not(cac:SellersItemIdentification)">[F-OCH161] There must be a SellersItemIdentification class for this profileID</sch:report>
			<!-- Validate -->
      <!-- [Release 20150915] Check removed according to issue: https://bugs.softwareborsen.dk/show_bug.cgi?id=1507 -->
			<!-- sch:report test="string-length(cbc:Name) &gt; 40">[W-OCH162] Invalid Name. Should not exceed 40 characters</sch:report -->
			<sch:report test="not(cbc:Description) and not(cac:BuyersItemIdentification) and not(cac:SellersItemIdentification) and not(cac:ManufacturersItemIdentification) and not(cac:StandardItemIdentification) and not(cac:CatalogueItemIdentification) and not(cac:AdditionalItemIdentification)">[F-OCH163] Description is mandatory if no ItemIdentification is present</sch:report>
			<sch:extends rule="DescriptionLanguageCheckNew"/>
		</sch:rule>
		<!-- Validate Description -->
	
		<!-- Validate PackQuantity -->
		<!-- Validate PackSizeNumeric -->
		<!-- Validate CatalogueIndicator -->
		<!-- Validate Name (OK) -->
		<!-- Validate HazardousRiskIndicator -->
		<!-- Validate AdditionalInformation -->
		<!-- Validate Keyword -->
		<!-- Validate BrandName -->
		<!-- Validate ModelName -->

		<!-- - - - - - - - - - - -  LineItem/Item/BuyersItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:BuyersItemIdentification">
			<sch:extends rule="DefaultItemIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Item/SellersItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:SellersItemIdentification">
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH164] Invalid ID. Must contain a value</sch:assert>
			<!-- <sch:report test="cac:IssuerParty">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>
		<!-- Validate Item/SellersItemIdentification/PhysicalAttribute -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:SellersItemIdentification/cac:PhysicalAttribute">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<sch:assert test="cbc:Description != ''">[F-OCH165] Invalid Description. Must contain a value</sch:assert>
			<!-- Validate -->
			<sch:assert test="cbc:AttributeID != ''">[F-OCH166] Invalid AttributeID. Must contain a value</sch:assert>
            <sch:extends rule="DescriptionLanguageCheckNew"/>
		</sch:rule>
		<!-- Validate Item/SellersItemIdentification/PhysicalAttribute/Description -->
		
		<!-- Validate Item/SellersItemIdentification/MeasurementDimension -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:SellersItemIdentification/cac:MeasurementDimension">
			<!-- Validate -->
			<sch:assert test="cbc:AttributeID != ''">[F-OCH167] Invalid AttributeID. Must contain a value</sch:assert>
            <sch:extends rule="DescriptionLanguageCheckNew"/>
		</sch:rule>
		<!-- Validate Item/SellersItemIdentification/MeasurementDimension/Description -->
		


		<!-- - - - - - - - - - - -  LineItem/Item/ManufacturersItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ManufacturersItemIdentification">
			<sch:extends rule="DefaultItemIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/StandardItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:StandardItemIdentification">
			<sch:extends rule="DefaultItemIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/CatalogueItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:CatalogueItemIdentification">
			<sch:extends rule="DefaultItemIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/AdditionalItemIdentification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:AdditionalItemIdentification">
			<sch:extends rule="DefaultItemIdentificationCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/CatalogueDocumentReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:CatalogueDocumentReference">
			<sch:extends rule="KnownDocumentReferenceCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/ItemSpecificationDocumentReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemSpecificationDocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/OriginCountry (excluded) - - - - - - - - - - -  -->

		<!-- - - - - - - - - - - -  LineItem/Item/CommodityClassification - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:CommodityClassification">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:report test="cbc:ItemClassificationCode and not(cbc:ItemClassificationCode/@listID='UNSPSC')">[W-OCH168] Use a Valid UNSPSC 19.0501 code</sch:report>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/TransactionConditions - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:TransactionConditions">
	    	<sch:extends rule="DescriptionLanguageCheckNew"/>
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
		</sch:rule>
		<!-- Validate Item/TransactionConditions/Description -->
	
		<!-- Validate Item/TransactionConditions/DocumentReference -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:TransactionConditions/cac:DocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/HazardousItem - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:HazardousItem">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/ClassifiedTaxCategory - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ClassifiedTaxCategory">
			<sch:extends rule="TaxCategoryCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/ClassifiedTaxCategory/TaxScheme - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ClassifiedTaxCategory/cac:TaxScheme">
			<sch:extends rule="TaxSchemeCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/AdditionalItemProperty - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:AdditionalItemProperty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:Name != ''">[F-OCH169] Invalid Name. Must contain a value</sch:assert>
			<sch:assert test="cbc:Value != ''">[F-OCH170] Invalid Value. Must contain a value</sch:assert>
		</sch:rule>
		<!-- - - - - - - - - - - -  LineItem/Item/AdditionalItemProperty/UsabilityPeriod - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:AdditionalItemProperty/cac:UsabilityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- - - - - - - - - - - -  LineItem/Item/AdditionalItemProperty/UsabilityPeriod/Description - - - - - - - - - - -  -->
		
		<!-- - - - - - - - - - - -  LineItem/Item/AdditionalItemProperty/ItemPropertyGroup - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:AdditionalItemProperty/cac:ItemPropertyGroup">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH171] Invalid ID. Must contain a value</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/ManufacturerParty - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ManufacturerParty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/InformationContentProviderParty - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:InformationContentProviderParty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  LineItem/Item/OriginAddress - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:OriginAddress">
			<sch:extends rule="AddressCheck"/>
		</sch:rule>

		<!-- - - - - - - - - - - -  Item/ItemInstance - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
		</sch:rule>
		<!-- Validate Item/ItemInstance/AdditionalItemProperty -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:AdditionalItemProperty">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:Name != ''">[F-OCH172] Invalid Name. Must contain a value</sch:assert>
			<sch:assert test="cbc:Value != ''">[F-OCH173] Invalid Value. Must contain a value</sch:assert>
		</sch:rule>
		<!-- Validate Item/ItemInstance/AdditionalItemProperty/UsabilityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:AdditionalItemProperty/cac:UsabilityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate Item/ItemInstance/AdditionalItemProperty/UsabilityPeriod/Description -->
		
		<!-- Validate Item/ItemInstance/AdditionalItemProperty/ItemPropertyGroup -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:AdditionalItemProperty/cac:ItemPropertyGroup">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH174] Invalid ID. Must contain a value</sch:assert>
		</sch:rule>
		<!-- Validate Item/ItemInstance/LotIdentification -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:LotIdentification">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
		</sch:rule>
		<!-- Validate Item/ItemInstance/LotIdentification/AdditionalItemProperty -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:LotIdentification/cac:AdditionalItemProperty">
			<sch:assert test="cbc:Name != ''">[F-OCH175] Invalid Name. Must contain a value</sch:assert>
			<sch:assert test="cbc:Value != ''">[F-OCH176] Invalid Value. Must contain a value</sch:assert>
		</sch:rule>
		<!-- Validate Item/ItemInstance/LotIdentification/AdditionalItemProperty/UsabilityPeriod -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:LotIdentification/cac:AdditionalItemProperty/cac:UsabilityPeriod">
			<sch:extends rule="DescriptionLanguageCheckNew"/>
			<sch:extends rule="PeriodCheck"/>
		</sch:rule>
		<!-- Validate Item/ItemInstance/LotIdentification/AdditionalItemProperty/UsabilityPeriod/Description -->
		
		<!-- Validate Item/ItemInstance/LotIdentification/AdditionalItemProperty/ItemPropertyGroup -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:LineItem/cac:Item/cac:ItemInstance/cac:LotIdentification/cac:AdditionalItemProperty/cac:ItemPropertyGroup">
			<!-- Validate -->
			<sch:assert test="cbc:ID != ''">[F-OCH177] Invalid ID. Must contain a value</sch:assert>
		</sch:rule>

		<!-- - - - - - - - - - - -  BuyerProposedSubstituteLineItem - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:BuyerProposedSubstituteLineItem">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<!-- <sch:report test="'1' = '1'">[I-OCH999] Validation not yet implemented!</sch:report> -->
		</sch:rule>

		<!-- - - - - - - - - - - -  QuotationLineReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:QuotationLineReference">
			<!-- Check for excluded elements -->
			<!-- Check for mandatory elements -->
			<!-- Validate -->
			<sch:assert test="cbc:LineID != ''">[F-OCH178] Invalid LineID. Must contain a value</sch:assert>
		</sch:rule>
		<!-- - - - - - - - - - - -  QuotationLineReference/DocumentReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:QuotationLineReference/cac:DocumentReference">
			<sch:extends rule="KnownDocumentReferenceCheck"/>
		</sch:rule>


		<!-- - - - - - - - - - - -  DocumentReference - - - - - - - - - - -  -->
		<sch:rule context="doc:OrderChange/cac:OrderLine/cac:DocumentReference">
			<sch:extends rule="DocumentReferenceCheck"/>
		</sch:rule>

	</sch:pattern>

</sch:schema>
